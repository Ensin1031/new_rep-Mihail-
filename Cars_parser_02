import openpyxl


class Car:

    def __init__(self, marka):
        if not isinstance(marka, str):
            raise ValueError('Введите строковое значение')
        self.marka = marka

    @staticmethod
    def __parser_xml(value):
        result = str()
        book = openpyxl.open('C:\\avtovoz_cars.xlsx', read_only=True)
        sheet_01 = book.active
        cells = sheet_01['a2':f'g{sheet_01.max_row}']
        for name, model, body, visual, form_money, drive, size in cells:
            if size.value == None:
                size_finish = 'нет'
            else:
                size_finish = 'да'
            if name.value == value:
                result += (f'{name.value} {model.value} {body.value}, '
                           f'Видимость системой: {visual.value}, Формат цен: {form_money.value}, '
                           f'Возможность транспортировки: {drive.value}, Вне габарита: {size_finish}\n')
        return result

    def __str__(self):
        return self.__parser_xml(self.marka)

    def __repr__(self):
        return self.__parser_xml(self.marka)
